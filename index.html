
<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <title>CISSP Practice Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: 2em auto; }
    h1, h2 { text-align: center; }
    .question { font-weight: bold; margin-bottom: 1em; }
    .options { list-style: none; padding: 0; }
    .options li { margin-bottom: 0.5em; }
    .feedback { margin-top: 1em; font-weight: bold; }
    .explanation { margin-top: 0.5em; background: #f9f9f9; padding: 1em; border-radius: 5px; }
    .score { margin-top: 1em; font-size: 1.1em; }
    .hidden { display: none; }
    .progress { margin-bottom: 1em; }
    .btn { padding: 0.5em 1em; font-size: 1em; }
    fieldset { margin-bottom: 1em; }
  </style>
</head>
<body>
  <h1>CISSP Practice Quiz</h1>
  <div id="app"></div>

  <script>
    // --- Sample Questions Data (expand this array with more extracted questions) ---
    const questions = [
      {
        id: 1,
        chapter: "Domain 1",
        test: null,
        question: "Alyssa is responsible for her organisation's security awareness programme. She is concerned that changes in technology may make the content outdated. What control can she put in place to protect against this risk?",
        options: ["Gamification", "Computer-based training", "Content reviews", "Live training"],
        correct: 2,
        explanation: "Alyssa should use periodic content reviews to continually verify that the content in her programme meets the organisation's needs and is up-to-date based upon the evolving risk landscape. She may do this using a combination of computer-based training, live training, and gamification, but those techniques do not necessarily verify that the content is updated."
      },
      {
        id: 2,
        chapter: "Domain 1",
        test: null,
        question: "Gavin is creating a report for management on the results of his most recent risk assessment. In his report, he would like to identify the remaining level of risk to the organisation after adopting security controls. What term best describes this current level of risk?",
        options: ["Inherent risk", "Residual risk", "Control risk", "Mitigated risk"],
        correct: 1,
        explanation: "The residual risk is the level of risk that remains after controls have been applied to mitigate risks. Inherent risk is the original risk that existed prior to the controls."
      },
      {
        id: 901,
        chapter: null,
        test: "Practice Test 1",
        question: "Lisa is attempting to prevent her network from being targeted by IP spoofing attacks as well as preventing her network from being the source of those attacks. Which of the following rules are best practices that Lisa should configure at her network border?",
        options: [
          "Block packets with internal source addresses from entering the network.",
          "Block packets with external source addresses from leaving the network.",
          "Block packets with public IP addresses from entering the network.",
          "Block packets with private IP addresses from exiting the network."
        ],
        correct: [0,1,3], // Multiple correct answers (example)
        explanation: "Packets with internal source addresses should never originate from outside the network, so they should be blocked from entering the network. Packets with external source addresses should never be found on the internal network, so they should be blocked from leaving the network. Private IP addresses should never be used on the Internet, so packets containing private IP addresses should be blocked from leaving the network."
      }
      // Add more questions here...
    ];

    // --- UI State ---
    let selectedQuestions = [];
    let currentIdx = 0;
    let score = 0;
    let answered = 0;
    let randomise = false;

    // --- Render Selection UI ---
    function renderSelectionUI() {
      document.getElementById('app').innerHTML = `
        <h2>Select Questions to Practise</h2>
        <form id="selectionForm">
          <fieldset>
            <legend>Domains (Chapters)</legend>
            <label><input type="checkbox" name="chapter" value="Domain 1"> Domain 1: Security and Risk Management</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 2"> Domain 2: Asset Security</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 3"> Domain 3: Security Architecture and Engineering</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 4"> Domain 4: Communication and Network Security</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 5"> Domain 5: Identity and Access Management</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 6"> Domain 6: Security Assessment and Testing</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 7"> Domain 7: Security Operations</label><br>
            <label><input type="checkbox" name="chapter" value="Domain 8"> Domain 8: Software Development Security</label>
          </fieldset>
          <fieldset>
            <legend>Practice Tests</legend>
            <label><input type="checkbox" name="test" value="Practice Test 1"> Practice Test 1</label><br>
            <label><input type="checkbox" name="test" value="Practice Test 2"> Practice Test 2</label><br>
            <label><input type="checkbox" name="test" value="Practice Test 3"> Practice Test 3</label><br>
            <label><input type="checkbox" name="test" value="Practice Test 4"> Practice Test 4</label>
          </fieldset>
          <fieldset>
            <legend>Options</legend>
            <label><input type="checkbox" name="randomise" value="yes"> Randomise Questions</label>
          </fieldset>
          <button type="submit" class="btn">Start Quiz</button>
        </form>
      `;
      document.getElementById('selectionForm').onsubmit = handleSelection;
    }

    // --- Handle Selection ---
    function handleSelection(e) {
      e.preventDefault();
      const form = e.target;
      const chapters = Array.from(form.querySelectorAll('input[name="chapter"]:checked')).map(cb => cb.value);
      const tests = Array.from(form.querySelectorAll('input[name="test"]:checked')).map(cb => cb.value);
      randomise = form.querySelector('input[name="randomise"]:checked') !== null;

      // Filter questions based on selection
      selectedQuestions = questions.filter(q =>
        (chapters.length && q.chapter && chapters.includes(q.chapter)) ||
        (tests.length && q.test && tests.includes(q.test))
      );
      // If nothing selected, use all questions
      if (selectedQuestions.length === 0) selectedQuestions = questions.slice();

      if (randomise) shuffle(selectedQuestions);

      // Reset state
      currentIdx = 0;
      score = 0;
      answered = 0;

      renderQuiz();
    }

    // --- Shuffle Array (Fisher-Yates) ---
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // --- Render Quiz UI ---
    function renderQuiz() {
      if (currentIdx >= selectedQuestions.length) {
        renderResults();
        return;
      }
      const q = selectedQuestions[currentIdx];
      const progress = `Question ${currentIdx + 1} of ${selectedQuestions.length}`;
      const scoreText = `Score: ${score} / ${answered}`;
      let optionsHtml = '';
      if (Array.isArray(q.correct)) {
        // Multiple correct answers (checkboxes)
        optionsHtml = q.options.map((opt, i) =>
          `<li><label><input type="checkbox" name="option" value="${i}"> ${String.fromCharCode(65 + i)}. ${opt}</label></li>`
        ).join('');
      } else {
        // Single correct answer (radio)
        optionsHtml = q.options.map((opt, i) =>
          `<li><button class="btn" onclick="selectAnswer(${i})">${String.fromCharCode(65 + i)}. ${opt}</button></li>`
        ).join('');
      }
      document.getElementById('app').innerHTML = `
        <div class="progress">${progress}</div>
        <div class="question">${q.question}</div>
        <ul class="options">${optionsHtml}</ul>
        <div id="feedback"></div>
        <div class="score">${scoreText}</div>
        <button id="nextBtn" class="btn hidden">Next</button>
      `;
      if (Array.isArray(q.correct)) {
        // For multiple correct, add submit button
        document.querySelector('.options').insertAdjacentHTML('afterend',
          `<button class="btn" id="submitMulti">Submit Answer</button>`);
        document.getElementById('submitMulti').onclick = () => selectMultiAnswer();
      }
      document.getElementById('nextBtn').onclick = nextQuestion;
    }

    // --- Handle Single Answer ---
    window.selectAnswer = function(selected) {
      const q = selectedQuestions[currentIdx];
      answered++;
      let correct = false;
      if (Array.isArray(q.correct)) {
        // Should not happen for single answer
      } else {
        correct = (selected === q.correct);
      }
      if (correct) score++;
      showFeedback(correct, q);
    };

    // --- Handle Multiple Answers ---
    function selectMultiAnswer() {
      const q = selectedQuestions[currentIdx];
      answered++;
      const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(cb => parseInt(cb.value));
      const correctSet = new Set(q.correct);
      const selectedSet = new Set(selected);
      const correct = selected.length === q.correct.length && selected.every(v => correctSet.has(v));
      if (correct) score++;
      showFeedback(correct, q, selected);
    }

    // --- Show Feedback ---
    function showFeedback(correct, q, selected=[]) {
      const feedbackDiv = document.getElementById('feedback');
      if (correct) {
        feedbackDiv.innerHTML = `<span class="feedback" style="color:green;">Correct!</span>`;
      } else {
        let correctAns;
        if (Array.isArray(q.correct)) {
          correctAns = q.correct.map(i => String.fromCharCode(65 + i)).join(', ');
        } else {
          correctAns = String.fromCharCode(65 + q.correct);
        }
        feedbackDiv.innerHTML = `
          <span class="feedback" style="color:red;">Incorrect.</span>
          <div>Correct answer: <strong>${correctAns}</strong></div>
          <div class="explanation"><strong>Explanation:</strong> ${q.explanation}</div>
        `;
      }
      // Disable all buttons/inputs
      document.querySelectorAll('.options button, .options input').forEach(btn => btn.disabled = true);
      const submitBtn = document.getElementById('submitMulti');
      if (submitBtn) submitBtn.disabled = true;
      document.getElementById('nextBtn').classList.remove('hidden');
      // Update score
      document.querySelector('.score').textContent = `Score: ${score} / ${answered}`;
    }

    // --- Next Question ---
    function nextQuestion() {
      currentIdx++;
      renderQuiz();
    }

    // --- Render Results ---
    function renderResults() {
      const percent = Math.round((score / answered) * 100);
      document.getElementById('app').innerHTML = `
        <h2>Quiz Complete!</h2>
        <div class="score">Final Score: ${score} / ${answered} (${percent}%)</div>
        <button class="btn" onclick="restartQuiz()">Try Again</button>
      `;
    }

    // --- Restart Quiz ---
    window.restartQuiz = function() {
      renderSelectionUI();
    };

    // --- Start ---
    renderSelectionUI();
  </script>
</body>
</html>
